name: DEV - Build/Deploy Docker Azure Webapp

# Controls when the workflow will run
on:

  # Allows you to run this workflow manually from the Actions tab.  This will only work for the default branch.
  workflow_dispatch:

  push:
    branches:
      - dev
    paths: 
      - 'AzureML/RealTimeInference/**'
      
# Build and deploy docker image to Azure webapp
jobs:
  build-deploy-docker-image:
    uses: ./.github/workflows/build-deploy-docker-image-BASE.yml
    with:
      JFROGREGISTRY: suncorenergy-aap-iaa-docker-dev-local.jfrog.io
      WEBAPP: iaasbxarmwebuw2031
      IMAGENAME: iaasbxarmwebuw2031
    secrets: 
      jfrog-username: ${{ secrets.JFROG_NONPROD_USERNAME }}
      jfrog-password: ${{ secrets.JFROG_NONPROD_PASSWORD }}
      azure-credential: ${{ secrets.SP_IAASBXARMMLWUW2033 }}
      azure-webapp-publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}
